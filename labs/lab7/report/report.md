---
## Front matter
title: "Лабораторная работа №7"
subtitle: "Элементы криптографии. Однократное гаммирование"
author: "Парфенова Елизавета Евгеньевна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Освоить на практике применение режима однократного гаммирования.

# Задание

Нужно подобрать ключ, чтобы получить сообщение «С Новым Годом,
друзья!». Требуется разработать приложение, позволяющее шифровать и
дешифровать данные в режиме однократного гаммирования. Приложение
должно:

1. Определить вид шифротекста при известном ключе и известном открытом тексте.

2. Определить ключ, с помощью которого шифротекст может быть преобразован в некоторый фрагмент текста, представляющий собой один из
возможных вариантов прочтения открытого текста.

# Теоретическое введение

**Криптография** — наука о методах обеспечения конфиденциальности, целостности данных, аутентификации, шифрования[@harm:bash].

**Гаммиирование**, или Шифр XOR, — метод симметричного шифрования, заключающийся в «наложении» последовательности, состоящей из случайных чисел, на открытый текст. Последовательность 
случайных чисел называется гамма-последовательностью и используется для зашифровывания и расшифровывания данных[@cript:bash]. 

С точки зрения теории криптоанализа метод шифрования однократной случайной равновероятной гаммой (однократное гаммирование) той же длины, что и открытый текст, является невскрываемым[@chipr:bash]. Даже при раскрытии части последовательности гаммы нельзя получить информацию о всём скрываемом тексте.

# Выполнение лабораторной работы

В ходе лабораторной работы было разработано требуемое приложение. Оно имеет следующие функции:

- **generate_random_key** - функция генерирует ключ шифрования на основе изначального текста. Ключ шифрования состоит из букв кириллицы, латиницы, цифр и различных символов;

- **xor** - функция, которая выполняет само гаммирование, накладывая гамму на скрываемый текст (по сути происходит сложение по модулю 2);

- **encrypt** - функция, шифрующая текст по сгенерированному ключу. Она совершает гаммирование и формирует сам шифротекст;

- **decrypt** - функция, которая, наоборот, расшифровывает шифротекст по определенному ключу. Работает анологично encrypt, только формируя в конце открытый текст;

- **find_key** - функция, которая ищет ключ по фрагменту изначального текста и шифротексту.

Вторая часть программы производит вызов всех созданных функций в определнной последовательности и совершает вывод необходимой информации: сгенерированного ключа, изначального текста, 
зашифрованного текста. расшифрованного текста, а также возможный вариантов прочтения шифротекста по фрагменту открытого текста. Причем, при расшифровке текста по фрагменту с помощью 
найденного клчюча (расшифрованный фрагмент всегда оставался неизменным (ни больше, ни меньше), какие бы манипуляции с кодом и выводом ни происходили) была добавлена зашифрованная часть этого же текста.
Еще раз подчеркну, что поиск ключа на основе фрагмента шифротекста и на основе всего шифротекста не давал никаких разлчий, все равно расшифровывался только изначальный фрагмент, что характерно для однократного гаммирования. 

Далее следует листинг описанной программы:


```
import random

def generate_random_key(text):
    possible_symbol = list(range(32, 127)) + list(range(1040, 1104))
    key_str = ''.join(chr(random.choice(possible_symbol)) for _ in range(len(text)))
    return key_str

def xor(text, key):
    return [ord(s1)^ord(s2) for s1,s2 in zip(text, key)]

def encrypt(text, key):
    chiphr = xor(text, key)
    chiphrotext = ''.join(chr(i) for i in chiphr)
    return chiphrotext
    
def decrypt(chiphro, key):
    decrypted = xor(chiphro, key)
    opentext = ''.join(chr(i) for i in decrypted)
    return opentext

def find_key(chiphrotext, text_fragment):
    chipher_fragment = chiphrotext[:(len(chiphrotext))]
    key_f = xor(text_fragment, chipher_fragment)
    found_key = ''.join(chr(i) for i in key_f)
    return found_key

text = "С Новым Годом, друзья!"
text_fragment = "С Новым"

key = generate_random_key(text)
print("Созданный ключ: ", key)

chiphrotext = encrypt(text, key)
print('Открытый текст: ', text)
print('Зашифрованный текст: ', chiphrotext)

opentext = decrypt(chiphrotext, key)
print('Расшифрованный текст: ', opentext)

found_key = find_key(chiphrotext, text_fragment) 
open_fragtext = decrypt(chiphrotext[:len(text_fragment)], found_key)
print('Один из возможных вариантов прочтения текста по фрагменту', open_fragtext + chiphrotext[len(text_fragment):])
```
При запуске программы мы получили следующий вывод (рис. [-@fig:001]).

![Результат работы программы](image/1jpg){#fig:001 width=70%}

Здесь мы видим, чтофункции сработали так, как мы предполагали и текст парвильно зашифровался по сгенерированному ключу и расшифровался, а также правильно был найден ключ 
шифрования для фрагмента этого же текста и нормально произведена его расшифровка. 


# Контрольные вопросы

1. Поясните смысл однократного гаммирования.

Однократное гаммирование — это метод симметричного шифрования, который заключается в наложении случайной последовательности (гаммы) на открытый текст с целью получения шифротекста. 
Гамма должна быть такой же длины, как и открытый текст, и используется только один раз для каждого сообщения. Этот метод обеспечивает высокий уровень безопасности, так как при правильном 
использовании он является невскрываемым, что означает, что даже если часть шифротекста будет известна, это не даст информации о других частях

2. Перечислите недостатки однократного гаммирования.

- Необходимость в длинной гамме: Для каждого сообщения требуется новая гамма той же длины, что и открытый текст, что делает процесс обмена ключами сложным и неудобным.

- Сложность генерации случайных чисел: Генерация качественной гаммы требует использования аппаратных генераторов случайных чисел, что может быть затруднительно.

- Уязвимость при повторном использовании гаммы: Если гамма будет использована повторно, это приведет к возможности криптоанализа

3. Перечислите преимущества однократного гаммирования.

- Абсолютная стойкость: При соблюдении условий (гамма случайна и используется только один раз) шифр является абсолютно стойким согласно теории Шеннона.
- Простота реализации: Шифрование и дешифрование выполняются одной и той же операцией (XOR), что упрощает реализацию алгоритма.
- Отсутствие зависимости от структуры данных: Метод не зависит от частотного анализа текста, так как гамма полностью случайна

4. Почему длина открытого текста должна совпадать с длиной ключа?

Длина открытого текста должна совпадать с длиной ключа (гаммы), чтобы каждый бит открытого текста мог быть зашифрован соответствующим битом гаммы. Это обеспечивает полное наложение и 
делает невозможным восстановление информации без полного доступа к гамме

5. Какая операция используется в режиме однократного гаммирования, назовите её особенности?

В режиме однократного гаммирования используется операция исключающего ИЛИ (XOR). Эта операция имеет следующие особенности:

- Она является симметричной: 
- Позволяет легко восстанавливать исходные данные при наличии ключа: 


6. Как по открытому тексту и ключу получить шифротекст?

Шифротекст можно получить с помощью операции XOR между открытым текстом и ключом

7. Как по открытому тексту и шифротексту получить ключ?

Ключ можно восстановить по битам шифротекста и открытого текста с помощью XOR

8. В чем заключаются необходимые и достаточные условия абсолютной
стойкости шифра?

Необходимые и достаточные условия для абсолютной стойкости шифра включают:

- Гамма должна быть случайной и независимой от открытого текста.
- Длина гаммы должна быть не меньше длины защищаемого сообщения.
- Гамма должна использоваться только один раз для каждого сообщения

# Выводы

В ходе лабораторной работы мы на практике освоили применение режима однократного гаммирования.

# Список литературы{.unnumbered}

::: {#refs}
:::
